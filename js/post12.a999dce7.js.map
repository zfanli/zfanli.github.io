{"version":3,"sources":["webpack:///./src/pages/2018-06-05-simple-usage-mongodb.md"],"names":["module","exports","attributes","title","subtitle","date","lastUpdateTime","tags","body","frontmatter"],"mappings":"2FAAAA,EAAAC,QAAA,CAAkBC,WAAA,CAAcC,MAAA,uBAAAC,SAAA,mDAAAC,KAAA,2BAAAC,eAAA,2BAAAC,KAAA,sBAAuMC,KAAA,ujgBAA86bC,YAAA","file":"js/post12.a999dce7.js","sourcesContent":["module.exports = {\"attributes\":{\"title\":\"ä»éœ€æ±‚æ¥çœ‹ MongoDB çš„æœ€ç®€å•ç”¨æ³•\",\"subtitle\":\"ä»éœ€æ±‚æ¥çœ‹çœ‹ç›®å‰æœ€æµè¡Œçš„ NoSQL æ•°æ®åº“ MongoDB çš„æœ€ç®€å•ç”¨æ³•ï¼ŒåŸºäº Pythonã€‚\",\"date\":\"2018-06-05T02:56:06.000Z\",\"lastUpdateTime\":\"2018-12-22T07:51:37.000Z\",\"tags\":[\"MongoDB\",\"Python\"]},\"body\":\"\\nä»éœ€æ±‚æ¥çœ‹ MongoDBï¼Œäº†è§£èƒ½æ»¡è¶³æˆ‘ä»¬éœ€æ±‚çš„æœ€ç®€ç”¨æ³•ã€‚\\n\\nè¿™ç¯‡æ–‡ç« ä»‹ç»å¦‚ä½•åœ¨ Python ä¸­æ“ä½œ MongoDBï¼Œé¢å‘åˆå­¦è€…ã€‚æˆ‘ä»¬ä½¿ç”¨ MongoDB æ¥å‚¨å­˜ä¸€ä¸ªç½‘ç«™çš„æ•°æ®ï¼Œå»æ»¡è¶³æ­å»ºä¸€ä¸ªåšå®¢ç½‘ç«™å¯èƒ½ä¼šé‡åˆ°çš„éœ€æ±‚ï¼Œä»¥æ­¤ä¸ºä¾‹æ¥ç†Ÿæ‚‰å’Œäº†è§£ MongoDBã€‚\\n\\nä»¥ä¸‹æ˜¯è¿™ç¯‡æ–‡ç« è®¨è®ºçš„å†…å®¹ï¼š\\n\\n- è®¾è®¡ç¬¦åˆéœ€æ±‚çš„æ•°æ®ç»“æ„\\n- document çš„å¢åˆ æ”¹æŸ¥\\n\\nè¿™äº›å†…å®¹æ˜¯åŸºç¡€çŸ¥è¯†ã€‚\\n\\n## è®¾è®¡ç¬¦åˆéœ€æ±‚çš„æ•°æ®ç»“æ„\\n\\n// TODO or delete\\n\\n// Or maybe extract this part as a single post.\\n\\n## document çš„å¢åˆ æ”¹æŸ¥\\n\\n### è¿æ¥ MongoDB\\n\\nè¿™æ˜¯ä¸€ä¸ªè¿æ¥ MongoDB çš„ç¤ºä¾‹ä»£ç ï¼Œä¸»è¦ç”¨æ¥å®šä¹‰å‡ ä¸ªå˜é‡æ–¹ä¾¿åé¢ä½¿ç”¨ã€‚\\n\\n```python\\nfrom pymongo import MongoClient\\nfrom bson import ObjectId\\n\\n\\nmc = MongoClient() # connect to default client\\ndb = mc['test'] # use 'test' database\\ncol = db['test-collection'] # use 'test-collection' collection\\n\\n```\\n\\n### find æŸ¥è¯¢\\n\\næŸ¥è¯¢æ˜¯ä½¿ç”¨æ•°æ®åº“çš„åŸºç¡€éœ€æ±‚ã€‚åœ¨ MongoDB ä¸­æŸ¥è¯¢åˆ†ä¸ºä¸¤ç§ï¼ŒæŸ¥è¯¢å•ä¸ªå€¼çš„ `find_one` å’ŒæŸ¥è¯¢å¤šä¸ªå€¼çš„ `find`ã€‚ä½¿ç”¨æ–¹æ³•ç¤ºä¾‹å¦‚ä¸‹ã€‚\\n\\n#### find_one & find\\n\\n```python\\n# Query for only one document\\ncol.find_one({\\n    'some_fields': 'values',\\n    'array_fields': ['value1', 'value2'],\\n    'object_fields': {'keys': 'values'}\\n})\\n# Query for one or more than one documents\\ncol.find({\\n    'some_fields': 'values',\\n    'array_fields': ['value1', 'value2'],\\n    'object_fields': {'keys': 'values'}\\n})\\n```\\n\\nä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çŸ¥é“ï¼ŒæŸ¥è¯¢æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œä¸”è¿™ä¸ªå‚æ•°éœ€è¦æ˜¯ `dict` å¯¹è±¡ç±»å‹ã€‚è¿™ä¸ªä¾‹å­å¦‚æœæ”¾åœ¨ SQL è¯­å¥ä¸­å¯¹åº” `select * from ... where ...` å¥å¼ã€‚\\n\\nä¸Šé¢çš„ä¾‹å­æŸ¥è¯¢æ¡ä»¶æ˜¯å‡ ä¸ªç²¾ç¡®å€¼ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„æŸ¥è¯¢æ¡ä»¶æ— æ³•å‡†ç¡®åˆ°ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œéœ€è¦é™å®šä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ã€‚MongoDB ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦æ¥åœˆå®šèŒƒå›´ï¼Œæ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ ğŸŒ°ã€‚\\n\\n```python\\ncol.find(\\n    {\\n        'views': {'$gte': 1000},\\n    }\\n)\\n```\\n\\nè¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ‰€æœ‰ `views` å€¼å¤§äºç­‰äº 1000 çš„æ–‡ç« ã€‚æ¯”è¾ƒæ“ä½œç¬¦ `$gte` è¡¨è¾¾å¤§äºç­‰äºçš„å…³ç³»ï¼Œè¿™æ˜¯ `greater than or equal to` çš„ç¼©å†™ï¼Œå«ä¹‰ç­‰åŒäº `>=`ã€‚\\n\\nå¸¸ç”¨çš„æ¯”è¾ƒæ“ä½œç¬¦æœ‰ä¸‹é¢è¿™äº›ï¼š\\n\\n- `$eq` equal to\\n- `$gt` greater than\\n- `$gte` greater than or equal to\\n- `$lt` less than\\n- `$lte` less than or equal to\\n- `$ne` not equal to\\n- `$in` match in an array\\n- `$nin` not match in an array\\n\\nè¿™äº›æ“ä½œç¬¦ä¸­ï¼Œ`$in` å’Œ `$nin` éœ€è¦åŒ¹é…æ•°ç»„ï¼Œä¾‹å¦‚ `$in` çš„è¡¨è¾¾æ–¹å¼å¦‚ä¸‹ï¼š\\n\\n```python\\n{'field_name': {'$in': ['value1', 'value2'...'values']}}\\n```\\n\\nè€Œå…¶ä»–çš„æ¯”è¾ƒæ“ä½œç¬¦éœ€è¦åŒ¹é…å•ä¸ªå€¼ï¼Œä¾‹å¦‚ `$eq` çš„è¡¨è¾¾æ–¹å¼å¦‚ä¸‹ï¼š\\n\\n```python\\n{'field_name': {'$eq': 'value'}}\\n```\\n\\nè¿™äº›æ“ä½œç¬¦å¯ç”¨äºæ‰€æœ‰æ¯”è¾ƒå…³ç³»ï¼Œä¸ä»…é™äº `find` æŸ¥è¯¢ï¼Œè¿˜åŒ…æ‹¬æ›´æ–°ã€åˆ é™¤å’Œ `aggregate` èšåˆç­‰åœºåˆã€‚\\n\\n#### project è®¡åˆ’å­—æ®µ\\n\\n`find` é»˜è®¤æ‹‰å–æ•´ä¸ª document ä½œä¸ºè¾“å‡ºï¼Œç±»ä¼¼ SQL çš„ `select * from table`ï¼Œè¿™æ„å‘³ç€å³ä½¿ä½ åªæƒ³è¦è¿™ä¸ªæ–‡æ¡£ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œä½ ä¹Ÿå°†å…ˆå¾—åˆ°æ•´ä¸ªæ–‡æ¡£ï¼Œç„¶åä»ä¸­å–å¾—ä½ æƒ³è¦çš„å­—æ®µã€‚é€šå¸¸å‡ºäºå¸¦å®½çš„é™åˆ¶ä»¥åŠæ€§èƒ½çš„è€ƒè™‘ï¼Œè¿™éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå¥½åœ¨æœ‰åŠæ³•åªå–æŸå‡ ä¸ªå­—æ®µï¼Œåœ¨ MongoDB ä¸­è¿™ä¸ªæ¦‚å¿µè¢«ç§°ä½œ `project`ã€‚\\n\\n`find` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å°†è¢«è§†ä¸º `projection`ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æ˜¯ `dict` å¯¹è±¡ç±»å‹ã€‚\\n\\n```python\\ncol.find(\\n    {},\\n    {\\n        'title': 1,\\n        'author': 1,\\n        'content': 1,\\n    }\\n)\\n```\\n\\nè¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­åˆ—å‡ºéœ€è¦çš„å­—æ®µåï¼Œå¹¶å°†å…¶å€¼è®¾ä¸º `1`ï¼Œ æˆ‘ä»¬å°±å®Œæˆäº†å¯¹éœ€è¦å­—æ®µçš„å£°æ˜ã€‚`projection` ä¸­å­—æ®µå¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ª flagï¼Œå½“å…¶ä¸º `1` çš„æ—¶å€™ï¼Œä»£è¡¨**åŒ…å«å…³ç³»**ï¼Œè®© MongoDB å¯ä»¥ç†è§£æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä»…å–å‡ºéœ€è¦çš„å­—æ®µã€‚\\n\\næˆ–è€…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å£°æ˜ä¸è¦è·å–å“ªäº›å­—æ®µã€‚\\n\\n```python\\ncol.find(\\n    {},\\n    {\\n        'comments': 0,\\n        'timestamp': 0,\\n        'reviews': 0,\\n    }\\n)\\n```\\n\\nä¸Šé¢è¯´åˆ° `projection` ä¸­å­—æ®µå¯¹åº”çš„å€¼æ˜¯ flagï¼Œé‚£ä¹ˆ `0` å°±è¡¨ç¤º**ä¸åŒ…å«å…³ç³»**ã€‚MongoDB ä¼šçŸ¥é“æˆ‘ä»¬çš„æ„æ€ï¼Œå¹¶ä¸”æŠŠæˆ‘ä»¬å£°æ˜ä¸éœ€è¦çš„å­—æ®µä»¥å¤–çš„æ•°æ®éƒ½å–å‡ºæ¥ï¼Œè¿™åœ¨ä¸€äº›åœºæ™¯ä¸‹å¾ˆæœ‰ç”¨ã€‚\\n\\nåœ¨ä½¿ç”¨ `projection` æ—¶éœ€è¦æ³¨æ„ï¼Œ`_id` å­—æ®µåœ¨ MongoDB ä¸­æœ‰ç‰¹æ®Šçš„åœ°ä½ï¼Œå³ä½¿æ²¡æœ‰è¢«å£°æ˜ä¸ºéœ€è¦è·å–çš„å­—æ®µï¼Œå…¶ä¾ç„¶ä¼šè¢«é»˜è®¤æŠ½å–å‡ºæ¥ã€‚ä½†å¦‚æœä½ ç¡®å®ä¸éœ€è¦å®ƒï¼Œå¯ä»¥åœ¨ `projection` ä¸­æ‰‹åŠ¨è®¾ç½®ä¸º `0`ï¼Œå®ƒå°±ä¸ä¼šå‡ºç°äº†ã€‚\\n\\n```python\\ncol.find(\\n    {},\\n    {\\n        '_id': 0,\\n        'title': 1,\\n        'author': 1,\\n        'content': 1,\\n    }\\n)\\n```\\n\\n**ä½†æ˜¯æ³¨æ„ï¼Œé™¤äº† `_id` ä»¥å¤–ï¼ŒåŒ…å«å…³ç³»ï¼ˆ`1`ï¼‰å’Œä¸åŒ…å«å…³ç³»ï¼ˆ`0`ï¼‰æ˜¯ä¸èƒ½å…±å­˜çš„ï¼Œå¦åˆ™ä½ ä¼šå¾—åˆ°ä¸‹é¢è¿™ä¸ªé”™è¯¯ã€‚**\\n\\n```\\npymongo.errors.OperationFailure: Projection cannot have a mix of inclusion and exclusion.\\n```\\n\\næ‰€ä»¥éœ€è¦è®°ä½ï¼Œå¯¹äº `_id` æ¥è¯´ï¼Œæƒ³è¦ä¸æ˜¾ç¤ºå®ƒéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸º `0`ã€‚ä½†å¯¹å…¶ä»–å­—æ®µæ¥è¯´ï¼Œåªèƒ½æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œå£°æ˜æ‰€æœ‰éœ€è¦è·å–çš„å­—æ®µï¼Œæˆ–è€…å£°æ˜æ‰€æœ‰ä¸éœ€è¦è·å–çš„å­—æ®µã€‚å¦‚æœä½ å°è¯•åŒæ—¶è¦æ±‚ MongoDB ç†è§£ä½ éœ€è¦å“ªäº›å­—æ®µå’Œä¸éœ€è¦å“ªäº›å­—æ®µï¼Œé‚£ä¹ˆåªèƒ½å¾—åˆ°æ— æƒ…çš„æŠ¥é”™ã€‚\\n\\n#### project è¿›é˜¶\\n\\nå£°æ˜è·å–å’Œä¸è·å–çš„å­—æ®µåªæ˜¯ `project` çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œé™¤æ­¤ä¹‹å¤–å®ƒè¿˜æœ‰å¾ˆå¤šå¾ˆå®ç”¨çš„èƒ½åŠ›ã€‚ä¾‹å¦‚å½“éœ€è¦æŸ¥è¯¢ä¸€ä¸ªæ•°ç»„å¯¹è±¡æ—¶ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›´é«˜ç²¾åº¦çš„æ“ä½œï¼Œæ¯”å¦‚åšè¯„è®ºçš„åˆ†é¡µæ—¶ï¼Œé€šå¸¸ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰è¯„è®ºæ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œæœ‰æ—¶ç”šè‡³æ˜¯æ˜‚è´µçš„ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `project` æ¥å¸®æˆ‘ä»¬åšä¸€äº›æ›´è¿›ä¸€æ­¥çš„æ“ä½œã€‚æ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ ğŸŒ°ã€‚\\n\\n```python\\ncol.find(\\n    {},\\n    {\\n        # Fetch the 0-3 of comments\\n        'comments': {\\n            '$slice': 3\\n        }\\n        # Fetch the 2-6 of comments\\n        'comments': {\\n            '$slice': [2, 6]\\n        }\\n        # Fetch the last comment\\n        'comments': {\\n            '$slice': -1\\n        }\\n    }\\n)\\n```\\n\\nä¸Šé¢çš„ä¾‹å­ä¸­å±•ç¤ºäº†æ•°ç»„åˆ‡ç‰‡æ“ä½œç¬¦çš„ç”¨æ³•ï¼Œå…¶æ•ˆæœç­‰åŒäº Python ä¸­æ•°ç»„çš„åˆ‡ç‰‡æ“ä½œã€‚ç¬¬ä¸€ä¸ª comments å–äº†æ•°ç»„çš„å‰3æ¡æ•°æ®ï¼Œç¬¬äºŒä¸ª comments å–å¾—äº†ç¬¬2æ¡åˆ°ç¬¬6æ¡çš„æ•°æ®ï¼Œæœ€åä¸€ä¸ª comments å–å¾—äº†å€’æ•°ç¬¬1æ¡æ•°æ®ã€‚\\n\\næˆ–è€…ï¼Œæœ‰æ—¶æˆ‘ä»¬ä»…éœ€è¦å–å‡ºç¬¦åˆè¦æ±‚çš„ç¬¬ä¸€ä¸ªè¯„è®ºï¼Œ\\n\\n```python\\ncol.find(\\n    {},\\n    {\\n        # Fetch the first deleted comment\\n        'comments': {\\n            '$elemMatch': {\\n                'deleted': True\\n            }\\n        }\\n    }\\n)\\n\\ncol.find(\\n    # Fetch the first element matched the condition\\n    {\\n        'comments': {\\n            'deleted': True\\n        }\\n    },\\n    {\\n        'comments.$': 1\\n    }\\n)\\n```\\n\\nä¸Šé¢çš„ä¸¤ä¸ªæŸ¥è¯¢çš„æ•ˆæœä¸€æ ·ï¼Œéƒ½æ˜¯è·å–è¯„è®ºæ•°ç»„ä¸­æ»¡è¶³åˆ é™¤ Flag ä¸º `true` è¿™ä¸ªæ¡ä»¶çš„ç¬¬ä¸€æ¡è¯„è®ºã€‚ä¸è¿‡è¿™ä¸ªä¾‹å­çš„åŒ¹é…ä¸–ç•Œä¸Šç”¨å¤„æœ‰é™ï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬éœ€è¦å–å‡ºçš„æ˜¯æ»¡è¶³æ¡ä»¶çš„å¤šæ¡è¯„è®ºï¼Œè€Œéæœ€åˆçš„æŸä¸€æ¡ã€‚ä½†æ˜¯ `project` è™½ç„¶æœ‰åŠæ³•å®ç°ï¼Œå´ä¸æ˜¯åœ¨ `find` æ–¹æ³•ä¸­å®ç°ï¼Œåœ¨ä¹‹åçš„å…³äº `aggregate` çš„æ–‡ç« ä¸­æˆ‘ä»¬å†ç»§ç»­è®¨è®ºå¦‚ä½•æ»¡è¶³è¿™ä¸ªéœ€æ±‚å§ã€‚\\n\\nç›®å‰ä¸ºæ­¢æ¶‰åŠçš„æ–‡æ¡£ï¼š\\n\\n- [Query Documents](https://docs.mongodb.com/manual/tutorial/query-documents/)\\n- [Comparison Query Operators](https://docs.mongodb.com/manual/reference/operator/query-comparison/)\\n- [Project Fields to Return from Query](https://docs.mongodb.com/manual/tutorial/project-fields-from-query-results/)\\n- [collection â€“ Collection level operations - find()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.find)\\n- [collection â€“ Collection level operations - find_one()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.find_one)\\n\\n### update æ›´æ–°\\n\\nä¿®æ”¹å·²æœ‰çš„æ•°æ®æ˜¯æ™®éçš„éœ€æ±‚ã€‚åœ¨æˆ‘ä»¬è¦è®¾è®¡çš„åšå®¢ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä¸»åŠ¨ä»¥åŠè¢«åŠ¨çš„æ“ä½œéƒ½ä¼šè§¦å‘æ•°æ®çš„å˜æ›´ï¼Œæ¯”å¦‚å½“ç”¨æˆ·æ‰“å¼€ä¸€ç¯‡æ–‡ç« æ—¶ï¼Œè¿™ç¯‡æ–‡ç« çš„æµè§ˆæ•°ä¼šå¾—åˆ°æ›´æ–°ï¼›å½“ç”¨æˆ·èµäº†è¿™ç¯‡æ–‡ç« æ—¶ï¼Œè¿™ç¯‡æ–‡ç« çš„ç‚¹èµæ•°ä¹Ÿä¼šå¾—åˆ°æ›´æ–°ï¼›æˆ–è€…å½“ç”¨æˆ·åœ¨çº¿ä¿®æ”¹äº†ä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼Œè¿™æ¬¡ä¿®æ”¹ä¹Ÿéœ€è¦æ­£ç¡®åœ°æ›´æ–°åˆ°æ•°æ®æºä¸Šã€‚\\n\\n#### update_one\\n\\n```python\\n# Get user inputted content\\nnew_content = get_user_input()\\n\\n# Update specified article\\ncol.update_one(\\n    # Match article by id\\n    {'_id': ObjectId('5b432a42f04705565525529d')},\\n    # Update content\\n    {\\n        '$set': {'content': new_content}\\n    }\\n)\\n```\\n\\nä¸Šé¢è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾é€šè¿‡ `get_user_input()` å‡½æ•°æ‹¿åˆ°äº†ç”¨æˆ·çš„è¾“å…¥æ•°æ®ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹æŒ‡å®šçš„æ–‡ç« åšäº†ä¸€æ¬¡æ›´æ–°ã€‚\\n\\nåœ¨ä¾‹å­ä¸­æˆ‘ä»¬ç»™ `update_one` æ–¹æ³•ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŸ¥è¯¢å‚æ•°ï¼Œå¯¹åº” SQL ä¸­çš„ `where` å°å¥ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›´æ–°å‚æ•°ï¼Œ`$set` æ˜¯æ›´æ–°æ“ä½œçš„æ“ä½œç¬¦ï¼Œå®ƒçš„å€¼ä¹Ÿæ˜¯ä¸€ä¸ª `dict` å¯¹è±¡ï¼Œæè¿°å°†ä»€ä¹ˆå­—æ®µæ›´æ–°æˆä»€ä¹ˆå€¼ï¼Œå¯¹åº” SQL ä¸­çš„ `update table set ...` å¥å¼ã€‚\\n\\nè¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ›´æ–°æ“ä½œï¼Œæˆ‘ä»¬å®é™…ä¸Šåšçš„æ˜¯ï¼š\\n\\næ›´æ–° `_id` ä¸ºç»™å®šå€¼çš„æ–‡ç« ï¼Œæ›´æ–°çš„å­—æ®µæ˜¯ `contentï¼ˆå†…å®¹ï¼‰`ï¼Œæ›´æ–°çš„å†…å®¹æ˜¯æˆ‘ä»¬ä¹‹å‰æ‹¿åˆ°çš„ç”¨æˆ·è¾“å…¥å€¼ `new_content`ã€‚\\n\\n> `_id` æ˜¯ MongoDB ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå­—æ®µï¼Œä½œä¸ºä¸»é”®æ¥æ ‡è¯†æ•°æ®çš„å”¯ä¸€æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡è€Œéå­—ç¬¦ä¸²ï¼Œåœ¨ Python ä¸­æŒ‡å®šçš„æ—¶å€™éœ€è¦ç”¨ `ObjectId(ï¼‰` æ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ª ID å¯¹è±¡ã€‚\\n\\n#### $inc æ•°å€¼å¢é‡\\n\\nå›åˆ°æ›´æ–°æ–‡å­—é˜…è¯»æ•°å’Œç‚¹èµæ•°çš„ä¾‹å­ğŸŒ°ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é˜…è¯»æ•°å’Œç‚¹èµæ•°å­—æ®µæ›´æ–°çš„ç»“æœæ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå¢åŠ 1ï¼Œè€Œä¸æ˜¯è®¾ç½®ä¸€ä¸ªå…·ä½“çš„å€¼ç»™ä»–ã€‚\\n\\n```python\\ncol.update_one(\\n    # Match article by id\\n    {'_id': ObjectId('5b432a42f04705565525529d')},\\n    # Update views\\n    {\\n        '$inc': {'views': 1}\\n    }\\n)\\n```\\n\\nMongoDB æä¾›äº†ä¸€ä¸ª `$inc` æ“ä½œç¬¦æ¥å®ç°ç»™æŒ‡å®šçš„å­—æ®µåšå¢é‡æ“ä½œã€‚æ‰€æœ‰æˆ‘ä»¬å®é™…çš„æ“ä½œæ˜¯ï¼šæ›´æ–° `_id` ä¸ºç»™å®šå€¼çš„æ–‡ç« ï¼Œæ›´æ–°çš„å­—æ®µæ˜¯ `viewsï¼ˆç‚¹å‡»é‡ï¼‰`ï¼Œæ›´æ–°çš„å†…å®¹æ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¸ŠåŠ 1ã€‚å½“ç„¶å¢é‡çš„å€¼æ˜¯æ ¹æ®éœ€è¦è®¾å®šçš„ã€‚\\n\\n```python\\ncol.update_one(\\n    # Match user by username\\n    {'username': 'Richard',\\n    # Update points\\n    {\\n        '$inc': {'points': 100}\\n    }\\n)\\n```\\n\\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™åä¸º Richard çš„ç”¨æˆ·å¢åŠ äº†100ç§¯åˆ†æ¥æ¿€åŠ±ä»–ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„ç½‘ç«™ã€‚\\n\\n```python\\ncol.update_one(\\n    # Match user by username\\n    {'username': 'Richard',\\n    # Update points\\n    {\\n        '$inc': {'points': -999}\\n    }\\n)\\n```\\n\\nè´Ÿå€¼å½“ç„¶ä¹Ÿæ˜¯å…è®¸çš„ï¼Œæ¥ç€å› ä¸ºå‰§æƒ…éœ€è¦æˆ‘ä»¬å‘ç°äº† Richard çš„è¿è§„è¡Œä¸ºï¼Œè°¨æ…è€ƒè™‘åæˆ‘ä»¬å†³å®šæ‰£é™¤999ç§¯åˆ†ä»¥ç¤ºæƒ©æˆ’ã€‚\\n\\nè¿™äº›æ“ä½œéƒ½å¯ä»¥ä½¿ç”¨ `$inc` å®Œæˆã€‚ä¸è¿‡å½“ç„¶æˆ‘ä»¬çš„åšå®¢ä¹Ÿä¸éœ€è¦ç§¯åˆ†ç³»ç»Ÿã€‚\\n\\nä¸Šé¢çš„ä¾‹å­éƒ½ä½¿ç”¨äº† `update_one` æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰å…¶åªå¯¹ä¸€ä¸ªç›®æ ‡è¿›è¡Œæ›´æ–°ï¼Œå½“æ›´æ–°å¤šä¸ªç›®æ ‡æ—¶æˆ‘ä»¬ç”¨åˆ°å¦ä¸€ä¸ªæ–¹æ³•ã€‚\\n\\n#### update_many\\n\\næˆ‘ä»¬å¯¹æ‰€æœ‰ç‚¹å‡»é‡è¶…è¿‡1000çš„æ–‡ç« è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œå°†å®ƒä»¬æ ‡æ³¨ä¸ºçƒ­ç‚¹æ–‡ç« ã€‚\\n\\n```python\\ncol.update_many(\\n    {'views': {'$gte': 1000}},\\n    {\\n        '$set': {'hot_topic': True}\\n    }\\n)\\n```\\n\\nä½¿ç”¨ `update_many` è¿›è¡Œæ‰¹é‡æ›´æ–°æ“ä½œæ—¶ï¼ŒåŒæ ·çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†ä½œä¸ºæŸ¥è¯¢å‚æ•°æ¥è´Ÿè´£ç­›é€‰å‡ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°åˆ™å°†æŒ‡å®šçš„å­—æ®µæ›´æ–°ä¸ºæ–°çš„å€¼ã€‚\\n\\n`update_many` ä¼šè¿”å›ä¸€ä¸ª `UpdateResult` å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«è¯¸å¦‚åŒ¹é…è¡Œæ•°å’Œä¿®æ”¹è¡Œæ•°ç­‰ä¿¡æ¯ã€‚\\n\\nä½†æ˜¯å½“æˆ‘ä»¬åœ¨è®¾è®¡ RESTful API çš„æ—¶å€™ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„å®è·µæ˜¯ï¼Œæ›´æ–°æ“ä½œå®Œæˆåå°†æ›´æ–°åçš„å¯¹è±¡ä½œä¸ºå“åº”å¯¹è±¡äº¤ä»˜ç»™å®¢æˆ·ç«¯ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¯·æ±‚æ•°é‡ï¼Œå¹¶ä¸”å‡†ç¡®çš„ä¿æŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„æ•°æ®ä¸€è‡´æ€§ã€‚\\n\\nè¦æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼Œå°±ç›®å‰æ‰€äº†è§£åˆ°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç„¶ååœ¨æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢æ“ä½œï¼Œå°†æ›´æ–°åçš„æ•°æ®å†æ¬¡å–å‡ºæ¥ã€‚ä½†è¿™å¤ªç¹çäº†ï¼Œæ²¡å…³ç³»ï¼Œæœ‰ä¸€ä¸ªæ›´å¥½çš„åŠæ³•å¯ä»¥ä½¿ç”¨ã€‚\\n\\n#### find_one_and_update\\n\\nä»åç§°ä¸Šæˆ‘ä»¬å°±å¯ä»¥è½»æ¾çš„ç†è§£è¿™ä¸ªæ–¹æ³•çš„å«ä¹‰ï¼Œå°±æ˜¯æŸ¥æ‰¾ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”æ›´æ–°å®ƒã€‚\\n\\n```python\\nfrom time import time\\nfrom pymongo import ReturnDocument\\n\\n# Get user inputted content\\nnew_content = get_user_input()\\n\\ncol.find_one_and_update(\\n    # Match article by id\\n    {\\n        '_id': ObjectId('5b432a42f04705565525529d')\\n    },\\n    # Update content and timestamp\\n    {\\n        '$set': {\\n            'content': new_content,\\n            'updated_time': time()\\n        }\\n    },\\n    # Project fields\\n    {\\n        'title': 1,\\n        'username': 1,\\n        'content': 1,\\n        'reviews': 1,\\n        'comment': 1,\\n        'updated_time': 1\\n    },\\n    # Return modified document\\n    return_document=ReturnDocument.AFTER\\n)\\n```\\n\\nä¾‹å­ğŸŒ°ç¨å¾®æœ‰ç‚¹é•¿ï¼Œé¦–å…ˆæˆ‘ä»¬å¯¼å…¥äº†ä¸¤ä¸ªå·¥å…·ã€‚å’Œä¹‹å‰ä¸€æ ·ï¼Œå‡è®¾æˆ‘ä»¬ä» `get_user_input()` æ–¹æ³•æ‹¿åˆ°äº†ç”¨æˆ·çš„è¾“å…¥å†…å®¹ï¼Œè¿™æ˜¯æˆ‘ä»¬å°†è¦æ›´æ–°çš„æ•°æ®ã€‚æ¥ç€ä½¿ç”¨ `find_one_and_update` æ¥æ›´æ–°æ•°æ®ã€‚\\n\\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½œä¸ºæŸ¥è¯¢å‚æ•°ï¼ŒåŒ¹é…ä¸€ä¸ªå”¯ä¸€çš„ `_id`ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›´æ–°å†…å®¹ï¼Œæˆ‘ä»¬å°† `content` æ›´æ–°ä¸ºæ–°çš„ç”¨æˆ·è¾“å…¥ï¼Œå¹¶ä¸”ä½¿ç”¨ `time()` å·¥å…·æ›´æ–°æ—¶é—´æˆ³ï¼›æ³¨æ„ï¼Œè¿™é‡Œå‡ºç°äº†**ç¬¬ä¸‰ä¸ªå‚æ•°**ï¼Œç”±äºè¦è¿›è¡Œä¸€æ¬¡æŸ¥æ‰¾æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ `project` è®¡åˆ’å­—æ®µæ¥æŒ‡å®šéœ€è¦çš„å­—æ®µã€‚å…³äºæ›´æ–°å’ŒæŸ¥æ‰¾çš„å‚æ•°å°±æ˜¯è¿™äº›ã€‚\\n\\nç¬¬å››ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œæ˜¯å¯ä»¥çœç•¥çš„ï¼Œä½†æ˜¯è¦å°å¿ƒï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ`find_one_and_update` æ–¹æ³•å°±å¦‚å…¶åï¼Œä¼šå…ˆæŸ¥æ‰¾å‡ºæ–‡æ¡£ï¼Œå†è¿›è¡Œæ›´æ–°æ“ä½œï¼Œè¿™æ ·çš„è¯è¿”å›çš„å°±æ˜¯**æ›´æ–°å‰çš„æ–‡æ¡£**ã€‚\\n\\næ˜¾ç„¶ï¼Œä¸ºäº†ä¿æŒæ•°æ®ä¸€è‡´æ€§æˆ‘ä»¬éœ€æ±‚çš„åº”è¯¥æ˜¯æ›´æ–°åçš„æ–‡æ¡£ï¼Œ`return_document` é€‰é¡¹å°±æ˜¯ç”¨æ¥æŒ‡å®šè¿™ä¸ªè¡Œä¸ºçš„ã€‚ä» `pymongo` åŒ…ä¸­å¯¼å…¥çš„ `ReturnDocument` å·¥å…·å¯ä»¥æä¾›å‡ ä¸ªé€‰é¡¹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°† `ReturnDocument.AFTER` è®¾ç½®ç»™ `return_document` å³å¯å‘Šè¯‰ MongoDB ç»™æˆ‘ä»¬æ›´æ–°åçš„æ–‡æ¡£ã€‚\\n\\nå…³äºæ›´æ–°ï¼Œäº†è§£è¿™äº›æƒ³å¿…æ­å»ºä¸€ä¸ª blog ç½‘ç«™æ˜¯å¤Ÿç”¨äº†ã€‚\\n\\nè¿™ä¸€éƒ¨åˆ†æ¶‰åŠçš„æ–‡æ¡£ï¼š\\n\\n- [Field Update Operators](https://docs.mongodb.com/manual/reference/operator/update-field/)\\n- [collection â€“ Collection level operations - update_one()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.update_one)\\n- [collection â€“ Collection level operations - update_many()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.update_many)\\n- [collection â€“ Collection level operations - find_one_and_update()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.find_one_and_update)\\n\\n### delete åˆ é™¤\\n\\nä¸€èˆ¬çš„åˆ é™¤æ“ä½œæˆ‘ä»¬ä»…åœ¨é€»è¾‘å±‚é¢ä¸Šå¯¹æ•°æ®è¿›è¡Œåˆ é™¤ï¼Œå…·ä½“çš„æ“ä½œæ˜¯è®¾å®šä¸€ä¸ªåˆ é™¤ Flagï¼Œå¯¹éœ€è¦åˆ é™¤çš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œå°†è¯¥ Flag å€¼æ›´æ–°ä¸º `True`ï¼Œè¿™æ ·åªéœ€è¦ç”¨åˆ°ä¸Šè¿°çš„æ›´æ–°æ–¹æ³•å°±å¯ä»¥å®Œæˆäº†ã€‚\\n\\né€»è¾‘åˆ é™¤çš„å¥½å¤„ä¹‹ä¸€æ˜¯åœ¨äºç•™æœ‰ä¸€äº›ä½™åœ°ï¼Œå½“æŸäº›æ•°æ®è¢«è¯¯åˆ é™¤æ—¶èƒ½å¤ŸåŠæ—¶å¾—åˆ°æ¢å¤ï¼Œæ¯•ç«Ÿæ•°æ®æ˜¯æœ€é‡è¦çš„ï¼Œè€Œå‚¨å­˜ç©ºé—´æ˜¯ä¾¿å®œçš„ã€‚\\n\\nä¸è¿‡å½“æŸäº›æ•°æ®è¢«æœ€ç»ˆè®¤å®šä¸ºæ— ç”¨æ•°æ®æ—¶ï¼Œå°±æ˜¯æ—¶å€™è¿›è¡Œç‰©ç†åˆ é™¤äº†ã€‚\\n\\n**åˆ é™¤æ“ä½œéå¸¸ç®€å•ï¼Œä½†åŒæ—¶éœ€è¦éå¸¸æ…é‡ã€‚**\\n\\n#### delete_one\\n\\n```python\\ncol.delete_one(\\n    # Delete specified article\\n    {'_id': ObjectId('5b432a42f04705565525529d')}\\n)\\n```\\n\\nä¸Šé¢çš„ä¾‹å­å°†åˆ é™¤ `_id` åŒ¹é…çš„æ–‡ç« ã€‚\\n\\n#### delete_many\\n\\n```python\\ncol.delete_many(\\n    # Delete articles which deleted flag is True\\n    {'deleted': True}\\n)\\n```\\n\\nä¸Šé¢çš„ä¾‹å­å°†åˆ é™¤æ‰€æœ‰è¢«é€»è¾‘åˆ é™¤çš„æ–‡ç« ã€‚åœ¨è¿™é‡Œé€»è¾‘åˆ é™¤ Flag åç§°æ˜¯ `deleted`ã€‚\\n\\nå¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯åˆ é™¤ä¸€ä¸ªç›®æ ‡è¿˜æ˜¯åˆ é™¤å¤šä¸ªç›®æ ‡ï¼Œå¯¹äºåˆ é™¤æ–¹æ³•æ¥è¯´åªéœ€è¦ä¸€ä¸ªåŒ¹é…å‚æ•°æ¥è¯†åˆ«æ•°æ®ã€‚\\n\\n#### find_one_and_delete\\n\\næœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦å°†åˆ é™¤çš„æ–‡æ¡£æ”¾åœ¨ response ä¸­è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ¥çœ‹çœ‹ä¾‹å­ğŸŒ°ã€‚\\n\\n```python\\ncol.find_one_and_delete(\\n    # Match article by id\\n    {\\n        '_id': ObjectId('5b432a42f04705565525529d')\\n    },\\n    # Project field_names\\n    {\\n        'title': 1,\\n        'username': 1,\\n        'content': 1,\\n        'reviews': 1,\\n        'comment': 1,\\n        'updated_time': 1\\n    }\\n)\\n```\\n\\nä¸Šé¢è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼ŒåŒ¹é… `_id` å¯¹åº”çš„æ–‡ç« ï¼Œåˆ é™¤å®ƒï¼Œç¬¬äºŒä¸ªå‚æ•°ä½œä¸º `project` å£°æ˜è·å–çš„å­—æ®µï¼Œæœ€ç»ˆæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ–‡æ¡£ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“ä¸Šè¿™ä¸ªæ–‡æ¡£å·²ç»è¢«åˆ é™¤äº†ã€‚\\n\\nåˆ é™¤æ“ä½œçœ‹ä¸Šå»å¾ˆç®€å•ï¼Œä½†æ˜¯ä¸€ä»½æ•°æ®è¢«åˆ é™¤çš„åæœå¯èƒ½ä¼šå¾ˆä¸¥é‡ï¼Œå¯¹äºåˆ é™¤æ“ä½œæˆ‘ä»¬åº”è¯¥å°å¿ƒæ…è¡Œï¼Œæ¯•ç«Ÿæ•°æ®æ— ä»·ã€‚\\n\\nè¿™éƒ¨åˆ†å†…å®¹æ¶‰åŠçš„æ–‡æ¡£ï¼š\\n\\n- [collection â€“ Collection level operations - delete_one()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.delete_one)\\n- [collection â€“ Collection level operations - delete_many()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.delete_many)\\n- [collection â€“ Collection level operations - find_one_and_delete()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.find_one_and_delete)\\n\\n### insert æ’å…¥\\n\\næ’å…¥æ“ä½œæ˜¯ä¿å­˜æ•°æ®çš„æ ¸å¿ƒã€‚äº†è§£å®ŒæŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œçš„ä½¿ç”¨æ–¹æ³•ï¼Œæ’å…¥æ“ä½œåˆ™æ˜¾å¾—å¾ˆç®€å•ã€‚\\n\\n#### insert_one\\n\\nå½“ç”¨æˆ·å‘è¡¨äº†1æ¡è¯„è®ºï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™æ¡è¯„è®ºä¿å­˜åˆ°æ­£ç¡®çš„æ–‡æ¡£ä¸‹é¢ã€‚\\n\\n```python\\ncol.insert_one(\\n    {\\n        'username': 'Richard',\\n        'article_id': ObjectId('5b432a42f04705565525529d'),\\n        'comment': 'Awesome!',\\n        'timestamp': 1531211551.682105\\n    }\\n)\\n```\\n\\nä¸Šé¢çš„ä¾‹å­å°†ä¿å­˜ä¸€æ¡æ¥è‡ªç”¨æˆ· Richard çš„è¯„è®ºï¼Œè™½ç„¶è¯„è®ºå†…å®¹æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯è¢«æ­£å¸¸çš„ä¿å­˜åœ¨æ•°æ®åº“äº†ã€‚æˆ–è®¸æˆ‘ä»¬åº”è¯¥æŠŠè¿™æ¡è¯„è®ºçš„ ID å‘å›å®¢æˆ·ç«¯ï¼Œè®©æˆ‘ä»¬ç¨å¾®ä¿®æ”¹ä¸‹è¿™ä¸ªä¾‹å­ã€‚\\n\\n```python\\nresult = col.insert_one(\\n    {\\n        'username': 'Richard',\\n        'article_id': ObjectId('5b432a42f04705565525529d'),\\n        'comment': 'Awesome!',\\n        'timestamp': 1531211551.682105\\n    }\\n)\\ncomment_id = result.inserted_id\\n```\\n\\nç”¨ä¸€ä¸ªå˜é‡æ¥å—æ’å…¥æ“ä½œçš„ç»“æœå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†æˆ‘ä»¬éœ€è¦çš„ IDï¼Œä½¿ç”¨ `inserted_id` key å¯ä»¥å°†å…¶å–å‡ºæ¥ã€‚ä½ æˆ–è®¸è§‰å¾—æœ‰äº›éº»çƒ¦ï¼Œä¸ºä½•æˆ‘ä»¬ä¸èƒ½æ‰‹åŠ¨è®¾ç½® IDï¼Œæˆ–è€…è®¾ç½®æˆ‘ä»¬æƒ³è¦çš„ IDï¼Ÿ\\n\\nå†ä¿®æ”¹ä¸€ä¸‹ä»£ç ã€‚\\n\\n```python\\ncol.insert_one(\\n    {\\n        '_id': 'cid007',\\n        'username': 'Richard',\\n        'article_id': ObjectId('5b432a42f04705565525529d'),\\n        'comment': 'Awesome!',\\n        'timestamp': 1531211551.682105\\n    }\\n)\\n```\\n\\nå½“æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šäº† ID å­—æ®µï¼ŒMongoDB å°†ä¸ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆæ–°çš„ IDï¼Œæœ‰äº›æ—¶å€™ä¼šæ¯”è¾ƒæœ‰ç”¨ï¼Œæ ¹æ®ä½ çš„ä¹ æƒ¯æ¥å†³å®šæ˜¯å¦éœ€è¦æ‰‹åŠ¨æ¥è®¾å®š ID å§ï¼\\n\\n#### insert_many\\n\\næœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦è€ƒè™‘åˆ°å‡å°‘è¯·æ±‚æ•°é‡ï¼Œä»…åœ¨æ”¶é›†äº†ä¸€äº›è¯„è®ºä¹‹åæ‰çœŸæ­£åˆ°è¿›è¡Œæ›´æ–°ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹æ˜¯å¦‚ä½•åŒæ—¶æ›´æ–°å¤šæ¡è¯„è®ºã€‚\\n\\n```python\\ncol.insert_many(\\n    [\\n        {\\n            'username': 'Richard',\\n            'article_id': ObjectId('5b432a42f04705565525529d'),\\n            'comment': 'Awesome!',\\n            'timestamp': 1531211551.682105\\n        },\\n        {\\n            'username': 'Richard',\\n            'article_id': ObjectId('5b432a42f04705565525529d'),\\n            'comment': 'Awesome again!',\\n            'timestamp': 1531212418.92356\\n        }\\n    ]\\n)\\n```\\n\\næˆ‘ä»¬åˆæ’å…¥äº†ä¸¤æ¡æ²¡æœ‰æ„ä¹‰çš„è¯„è®ºã€‚\\n\\nå¯ä»¥çœ‹åˆ° `insert_many` æ¥æ”¶ä¸€ä¸ªæ–‡æ¡£ listï¼ŒåŒæ ·çš„ï¼Œå¦‚æœéœ€è¦å¾—åˆ° IDï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå˜é‡æ¥æ”¶æ’å…¥æ“ä½œçš„ç»“æœï¼Œä½¿ç”¨ `inserted_ids` æ¥è·å¾— IDï¼Œä½†æ˜¯æ³¨æ„ï¼Œè·å¾—çš„å°†ä¼šæ˜¯ä¸€ä¸ª ID çš„ listã€‚\\n\\næ’å…¥æ“ä½œåŒæ ·å¾ˆç®€å•ã€‚ä½†æ˜¯ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¼¼ä¹é»˜è®¤äº†ä¸€ä¸ªäº‹å®ï¼Œå°†è¯„è®ºå‚¨å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„ collection ä¸­ã€‚\\n\\nMongoDB æ˜¯ä¸€ä¸ªæ–‡æ¡£æ•°æ®åº“ï¼Œä¸åº”è¯¥ç”¨ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“çš„æ€è·¯æ¥çœ‹å¾…å®ƒï¼Œå¯¹äºæ–‡ç« å’Œè¯„è®ºè¿™ç§å…¸å‹çš„ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå†…åµŒæ•°ç»„ä¼šæ˜¯ä¸€ç§æ›´å¥½çš„æ•°æ®ç»“æ„ã€‚\\n\\n```python\\narticles = {\\n    # Article ID\\n    '_id': '5b33af56d2cbe686e00b75c9',\\n    # Other field_names\\n    # ...\\n    # Comments\\n    'comments': [\\n        {\\n            # Comment ID\\n            'cid': '5b3dc242f0470538510b28d7',\\n            # Username\\n            'from': 'Richard',\\n            # Comment body\\n            'body': 'Content of comment.',\\n            # Created or updated timestamp\\n            'timestamp': 1529248843.301676,\\n            # Deleted flag\\n            'deleted': False\\n        },\\n        # ...\\n    ],\\n    # Created or updated timestamp\\n    'timestamp': 1529248869.717813,\\n    # ...\\n}\\n```\\n\\nè¯„è®ºä½œä¸ºä¸€ä¸ª list å†…åµŒåœ¨æ‰€å±çš„æ–‡ç« æ–‡æ¡£é‡Œï¼Œè¿™æ—¶æ·»åŠ ä¸€ä¸ªè¯„è®ºä¸å†æ˜¯æ’å…¥æ“ä½œäº†ï¼Œå®ƒå˜æˆäº†ä¸€ä¸ªæ›´æ–°æ“ä½œã€‚\\n\\n#### update array use $push\\n\\n```python\\ncol.update_one(\\n    {'_id': Object('5b33af56d2cbe686e00b75c9')},\\n    {\\n        '$push': {\\n            'comments': {\\n                'username': 'Richard',\\n                'cid': ObjectId(),\\n                'comment': 'Awesome!',\\n                'timestamp': 1531211551.682105\\n            }\\n        }\\n    }\\n)\\n```\\n\\nä½¿ç”¨ `$push` æ“ä½œç¬¦å¯ä»¥å°†ä¸€æ¡è¯„è®ºæ·»åŠ åˆ°è¯„è®º list ä¸­ã€‚è€Œç”±äºè¯„è®ºä¸å†æ˜¯å•ç‹¬çš„æ–‡æ¡£ï¼Œä¸å†è‡ªåŠ¨ç”Ÿæˆ ID å±æ€§ï¼Œå¦‚æœéœ€è¦çš„è¯æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ä¸å¸¦å‚æ•°çš„ `ObjectId()` æ¥æ‰‹åŠ¨ç”Ÿæˆä¸€ä¸ª ID å±æ€§ã€‚\\n\\nè¿™éƒ¨åˆ†æ¶‰åŠçš„æ–‡æ¡£ï¼š\\n\\n- [collection â€“ Collection level operations - insert_one()](http://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.insert_one)\\n- [collection â€“ Collection level operations - insert_many()](hhttp://api.mongodb.com/python/current/api/pymongo/collection.html#pymongo.collection.Collection.insert_many)\\n- [results â€“ Result class definitions - InsertOneResult](http://api.mongodb.com/python/current/api/pymongo/results.html#pymongo.results.InsertOneResult)\\n- [results â€“ Result class definitions - InsertManyResult](http://api.mongodb.com/python/current/api/pymongo/results.html#pymongo.results.InsertManyResult)\\n- [Array Update Operators](https://docs.mongodb.com/manual/reference/operator/update-array/)\\n\\n### æ€»ç»“\\n\\nç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº† MongoDB çš„å¢åˆ æ”¹æŸ¥çš„æ“ä½œã€‚æ— è®ºå¢åˆ æ”¹æŸ¥ï¼Œéƒ½æœ‰ä¸¤ç§æ¨¡å¼ï¼Œæ“ä½œå•ä¸€æ–‡æ¡£çš„æ–¹æ³•åç¼€éƒ½æ˜¯ `one`:\\n\\n- insert_one\\n- delete_one\\n- update_one\\n- find_one\\n\\nè€Œæ“ä½œå¤šä¸ªæ–‡ä»¶åŸºæœ¬éƒ½æ˜¯åŠ åç¼€ `many`ï¼Œåªæœ‰ `find` æ˜¯ç‰¹æ®Šçš„ï¼Œä»€ä¹ˆéƒ½ä¸åŠ ï¼š\\n\\n- insert_many\\n- delete_many\\n- update_many\\n- find\\n\\nå¯¹äºæ›´æ–°æˆ–è€…åˆ é™¤ä¹‹åçš„æ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦æ‹¿åˆ°æ›´æ–°åæˆ–è€…åˆ é™¤å‰çš„æ–‡æ¡£è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¾ˆå®ç”¨ï¼š\\n\\n- find_one_and_update\\n- find_one_and_delete\\n\\nä½†æ˜¯æ³¨æ„ï¼Œ`find_one_and_update` é»˜è®¤è¿”å›æ›´æ–°å‰çš„æ–‡æ¡£ï¼Œè®¾å®š `return_document=ReturnDocument.AFTER` å¯ä»¥å˜æ›´é»˜è®¤è¡Œä¸ºï¼Œè®©å®ƒè¿”å›ä¿®æ”¹åçš„æ–‡æ¡£ã€‚\\n\\nå¯¹äºæŸ¥è¯¢æ¥è¯´ï¼Œæˆ‘ä»¬è¿˜äº†è§£äº† `project` çš„æ¦‚å¿µï¼Œä»¥æ­¤æ¥å£°æ˜æˆ‘ä»¬éœ€è¦å“ªäº›å­—æ®µã€‚\\n\\nå¯¹äº `project` è¦æ³¨æ„ä¸¤ç‚¹ï¼š\\n\\n- `_id` æ˜¯é»˜è®¤ä¼šå–å‡ºçš„ï¼Œé™¤éåœ¨ `project` ä¸­æ˜¾ç¤ºåœ°å£°æ˜ä¸åŒ…å«å…³ç³»ï¼ˆè®¾ä¸º `0`ï¼‰\\n- `_id` ä»¥å¤–çš„å­—æ®µï¼Œåœ¨ `project` ä¸­ä¸å¯ä»¥åŒæ—¶å£°æ˜åŒ…å«å…³ç³»ï¼ˆè®¾ä¸º `1`ï¼‰å’Œä¸åŒ…å«å…³ç³»ï¼ˆè®¾ä¸º `0`ï¼‰ï¼Œå¦åˆ™å°†ä¼šæŠ¥é”™\\n\\né™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜çœ‹äº†çœ‹ MongoDB ä¸­çš„æ¯”è¾ƒæ“ä½œç¬¦ï¼Œå¿«é€Ÿæ‰«ä¸€çœ¼ï¼š\\n\\n- `$eq` equal to\\n- `$gt` greater than\\n- `$gte` greater than or equal to\\n- `$lt` less than\\n- `$lte` less than or equal to\\n- `$ne` not equal to\\n- `$in` match in an array\\n- `$nin` not match in an array\\n\\nç„¶åï¼Œè¿˜æœ‰æ›´æ–°æ“ä½œç¬¦ï¼š\\n\\n- `$set` è®¾ç½®æ›´æ–°å­—æ®µå†…å®¹\\n- `$inc` è®¾ç½®æ›´æ–°å­—æ®µå¢é‡\\n- `$push` æ·»åŠ ä¸€ä¸ªå¯¹è±¡åˆ°å†…åµŒæ•°ç»„\\n\\næ„Ÿè§‰å¦‚ä½•ï¼Ÿæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ\\n\\nä½†æ˜¯ç­‰ç­‰ï¼å¦‚æœä½ ç†Ÿæ‚‰ SQL çš„è¯å¯èƒ½ä¼šæƒ³ï¼Œé™¤äº†è¿™äº›åŸºç¡€çš„åŠŸèƒ½ï¼Œåœ¨ SQL ä¸­å®ç”¨çš„ `GROUP BY`ã€`MAX`ã€`SUM` ç”šè‡³ `PARTITION BY` ç­‰åˆ†æå‡½æ•°åœ¨ MongoDB ä¸­æ²¡æœ‰å¯¹åº”çš„å®ç°å—ï¼Ÿ\\n\\nç­”æ¡ˆå½“ç„¶æ˜¯æœ‰çš„ï¼å¹¶ä¸”æˆ‘ä»¬éœ€è¦çš„å¤§éƒ¨åˆ†åˆ†æå‡½æ•°åœ¨ MongoDB ä¸­éƒ½æœ‰ç›¸åº”çš„å®ç°ã€‚MongoDB ä½¿ç”¨ `aggregate` æ¥æ»¡è¶³å„ç§æ•°æ®åˆ†æçš„éœ€æ±‚ï¼Œå¦‚æœæœ‰æœºä¼šåœ¨ä¹‹åçš„æ–‡ç« ä¸­æˆ‘ä»¬å†æ¥è®¨è®ºä¸€ä¸‹èšåˆçš„ç”¨æ³•å§ã€‚\\n\\nåˆ‡å®éœ€è¦çš„ä¸œè¥¿æ‰èƒ½åœ¨æˆ‘ä»¬çš„è®°å¿†ä¸­ä¿ç•™ä¸€å¸­ä¹‹åœ°ï¼Œè¿‡å¤šå®é™…ç”¨ä¸åˆ°çš„ï¼Œæˆ–è€…è¿‘æœŸç”¨ä¸åˆ°çš„ä¿¡æ¯ï¼Œåªä¼šè®©è®°å¿†ç³»ç»Ÿè¶‹äºæ··æ²Œã€‚ç›®å‰æˆ‘ä»¬å·²ç»äº†è§£äº†è¶³å¤Ÿçš„çŸ¥è¯†æ¥ä½¿ MongoDB ä¸ºæˆ‘ä»¬æ‰€ç”¨äº†ã€‚ç­‰åˆ°éœ€æ±‚æˆ–è€…æ±‚çŸ¥æ¬²ç»§ç»­å»¶ä¼¸ï¼Œå°±æ˜¯è¿›ä¸€æ­¥å­¦ä¹ çš„æœ€å¥½æ—¶æœºã€‚\\n\",\"frontmatter\":\"title: ä»éœ€æ±‚æ¥çœ‹ MongoDB çš„æœ€ç®€å•ç”¨æ³•\\nsubtitle: ä»éœ€æ±‚æ¥çœ‹çœ‹ç›®å‰æœ€æµè¡Œçš„ NoSQL æ•°æ®åº“ MongoDB çš„æœ€ç®€å•ç”¨æ³•ï¼ŒåŸºäº Pythonã€‚\\ndate: 2018-06-05 10:56:06 +8\\nlastUpdateTime: 2018-12-22 15:51:37 +8\\ntags:\\n  - MongoDB\\n  - Python\"}"],"sourceRoot":""}